
    A simple jQuery modal (httpgithub.comkylefoxjquery-modal)
    Version 0.9.1

!function(o){object==typeof module&&object==typeof module.exportso(require(jquery),window,document)o(jQuery,window,document)}(function(o,t,i,e){var s=[],l=function(){return s.lengths[s.length-1]null},n=function(){var o,t=!1;for(o=s.length-1;o=0;o--)s[o].$blocker&&(s[o].$blocker.toggleClass(current,!t).toggleClass(behind,t),t=!0)};o.modal=function(t,i){var e,n;if(this.$body=o(body),this.options=o.extend({},o.modal.defaults,i),this.options.doFade=!isNaN(parseInt(this.options.fadeDuration,10)),this.$blocker=null,this.options.closeExisting)for(;o.modal.isActive();)o.modal.close();if(s.push(this),t.is(a))if(n=t.attr(href),this.anchor=t,^#.test(n)){if(this.$elm=o(n),1!==this.$elm.length)return null;this.$body.append(this.$elm),this.open()}else this.$elm=o(div),this.$body.append(this.$elm),e=function(o,t){t.elm.remove()},this.showSpinner(),t.trigger(o.modal.AJAX_SEND),o.get(n).done(function(i){if(o.modal.isActive()){t.trigger(o.modal.AJAX_SUCCESS);var s=l();s.$elm.empty().append(i).on(o.modal.CLOSE,e),s.hideSpinner(),s.open(),t.trigger(o.modal.AJAX_COMPLETE)}}).fail(function(){t.trigger(o.modal.AJAX_FAIL);var i=l();i.hideSpinner(),s.pop(),t.trigger(o.modal.AJAX_COMPLETE)});else this.$elm=t,this.anchor=t,this.$body.append(this.$elm),this.open()},o.modal.prototype={constructoro.modal,openfunction(){var t=this;this.block(),this.anchor.blur(),this.options.doFadesetTimeout(function(){t.show()},this.options.fadeDurationthis.options.fadeDelay)this.show(),o(i).off(keydown.modal).on(keydown.modal,function(o){var t=l();27===o.which&&t.options.escapeClose&&t.close()}),this.options.clickClose&&this.$blocker.click(function(t){t.target===this&&o.modal.close()})},closefunction(){s.pop(),this.unblock(),this.hide(),o.modal.isActive()o(i).off(keydown.modal)},blockfunction(){this.$elm.trigger(o.modal.BEFORE_BLOCK,[this._ctx()]),this.$body.css(overflow,hidden),this.$blocker=o('div class='+this.options.blockerClass+' blocker currentdiv').appendTo(this.$body),n(),this.options.doFade&&this.$blocker.css(opacity,0).animate({opacity1},this.options.fadeDuration),this.$elm.trigger(o.modal.BLOCK,[this._ctx()])},unblockfunction(t){!t&&this.options.doFadethis.$blocker.fadeOut(this.options.fadeDuration,this.unblock.bind(this,!0))(this.$blocker.children().appendTo(this.$body),this.$blocker.remove(),this.$blocker=null,n(),o.modal.isActive()this.$body.css(overflow,))},showfunction(){this.$elm.trigger(o.modal.BEFORE_OPEN,[this._ctx()]),this.options.showClose&&(this.closeButton=o('a href=#close-modal rel=modalclose class=close-modal '+this.options.closeClass+''+this.options.closeText+a),this.$elm.append(this.closeButton)),this.$elm.addClass(this.options.modalClass).appendTo(this.$blocker),this.options.doFadethis.$elm.css({opacity0,displayinline-block}).animate({opacity1},this.options.fadeDuration)this.$elm.css(display,inline-block),this.$elm.trigger(o.modal.OPEN,[this._ctx()])},hidefunction(){this.$elm.trigger(o.modal.BEFORE_CLOSE,[this._ctx()]),this.closeButton&&this.closeButton.remove();var t=this;this.options.doFadethis.$elm.fadeOut(this.options.fadeDuration,function(){t.$elm.trigger(o.modal.AFTER_CLOSE,[t._ctx()])})this.$elm.hide(0,function(){t.$elm.trigger(o.modal.AFTER_CLOSE,[t._ctx()])}),this.$elm.trigger(o.modal.CLOSE,[this._ctx()])},showSpinnerfunction(){this.options.showSpinner&&(this.spinner=this.spinnero('div class='+this.options.modalClass+'-spinnerdiv').append(this.options.spinnerHtml),this.$body.append(this.spinner),this.spinner.show())},hideSpinnerfunction(){this.spinner&&this.spinner.remove()},_ctxfunction(){return{elmthis.$elm,$elmthis.$elm,$blockerthis.$blocker,optionsthis.options}}},o.modal.close=function(t){if(o.modal.isActive()){t&&t.preventDefault();var i=l();return i.close(),i.$elm}},o.modal.isActive=function(){return s.length0},o.modal.getCurrent=l,o.modal.defaults={closeExisting!0,escapeClose!0,clickClose!0,closeTextClose,closeClass,modalClassmodal,blockerClassjquery-modal,spinnerHtml'div class=rect1divdiv class=rect2divdiv class=rect3divdiv class=rect4div',showSpinner!0,showClose!0,fadeDurationnull,fadeDelay1},o.modal.BEFORE_BLOCK=modalbefore-block,o.modal.BLOCK=modalblock,o.modal.BEFORE_OPEN=modalbefore-open,o.modal.OPEN=modalopen,o.modal.BEFORE_CLOSE=modalbefore-close,o.modal.CLOSE=modalclose,o.modal.AFTER_CLOSE=modalafter-close,o.modal.AJAX_SEND=modalajaxsend,o.modal.AJAX_SUCCESS=modalajaxsuccess,o.modal.AJAX_FAIL=modalajaxfail,o.modal.AJAX_COMPLETE=modalajaxcomplete,o.fn.modal=function(t){return 1===this.length&&new o.modal(this,t),this},o(i).on(click.modal,'a[rel~=modalclose]',o.modal.close),o(i).on(click.modal,'a[rel~=modalopen]',function(t){t.preventDefault(),o(this).modal()})});